#!/bin/bash
#$ -wd "$HOME"/zinb_analysis/sims/figures/fig6ad-S13-S14
#$ -V
#$ -l h_rt=24:00:00,h_vmem=30G
#$ -N fitZinb10000
#$ -t 1-54:1
#$ -tc 15
#$ -pe smp 1
#$ -o "$HOME"/logs/"$JOB_NAME"_"$TASK_ID"_o.txt
INPUT=("Allen 10000 10 0"
"Allen 10000 10 2"
"Allen 10000 10 5"
"Allen 10000 1 0"
"Allen 10000 1 2"
"Allen 10000 1 5"
"Allen 10000 5 0"
"Allen 10000 5 2"
"Allen 10000 5 5"
"Allen 1000 10 0"
"Allen 1000 10 2"
"Allen 1000 10 5"
"Allen 1000 1 0"
"Allen 1000 1 2"
"Allen 1000 1 5"
"Allen 1000 5 0"
"Allen 1000 5 2"
"Allen 1000 5 5"
"Allen 100 10 0"
"Allen 100 10 2"
"Allen 100 10 5"
"Allen 100 1 0"
"Allen 100 1 2"
"Allen 100 1 5"
"Allen 100 5 0"
"Allen 100 5 2"
"Allen 100 5 5"
"Zeisel 10000 10 0.5"
"Zeisel 10000 10 -1.5"
"Zeisel 10000 10 2"
"Zeisel 10000 1 0.5"
"Zeisel 10000 1 -1.5"
"Zeisel 10000 1 2"
"Zeisel 10000 5 0.5"
"Zeisel 10000 5 -1.5"
"Zeisel 10000 5 2"
"Zeisel 1000 10 0.5"
"Zeisel 1000 10 -1.5"
"Zeisel 1000 10 2"
"Zeisel 1000 1 0.5"
"Zeisel 1000 1 -1.5"
"Zeisel 1000 1 2"
"Zeisel 1000 5 0.5"
"Zeisel 1000 5 -1.5"
"Zeisel 1000 5 2"
"Zeisel 100 10 0.5"
"Zeisel 100 10 -1.5"
"Zeisel 100 10 2"
"Zeisel 100 1 0.5"
"Zeisel 100 1 -1.5"
"Zeisel 100 1 2"
"Zeisel 100 5 0.5"
"Zeisel 100 5 -1.5"
"Zeisel 100 5 2")
eval "Rscript -e $(printf "\"source('fitZinb10000.R'); fitSim(ds=\'%s\', nc=%s, b2=%s, offs=%s, BPPARAM=SerialParam())\"" ${INPUT[$SGE_TASK_ID - 1]})"
